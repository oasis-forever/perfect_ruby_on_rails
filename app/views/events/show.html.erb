<h1 class="mt-3 mb-3"><%= @event.name %></h1>
<div id="content" class="card mb-2">
  <h5 class="card-header">イベント内容</h5>
  <div class="card-body">
    <p class="card-text"><%= @event.content %></p>
  </div>
</div>
<div id="time-from-to" class="card mb-2">
  <h5 class="card-header">開催時刻</h5>
  <div class="card-body">
    <p class="card-text">
      <%= "#{l(@event.start_at, format: :long)} - #{l(@event.end_at, format: :long)}" %>
    </p>
  </div>
</div>
<div id="place" class="card mb-2">
  <h5 class="card-header">開催場所</h5>
  <div class="card-body">
    <p class="card-text"><%= @event.place %></p>
  </div>
</div>
<div id="owner" class="card mb-2">
  <h5 class="card-header">主催者</h5>
  <div class="card-body">
    <%= link_to("https://github.com/#{@event.owner.name}", class: 'card-link') do %>
      <%= image_tag @event.owner.image_url, width: 50, height: 50 %>
      <%= "@#{@event.owner.name}" %>
    <% end %>
  </div>
</div>
<div id="participants" class="card mb-2">
  <h5 class="card-header">参加者</h5>
  <div class="card-body">
    <% @tickets.each do |ticket| %>
      <%= link_to("https://github.com/#{ticket.user.name}", class: 'card-link') do %>
        <%= image_tag ticket.user.image_url, width: 50, height: 50 %>
        <%= "@#{ticket.user.name}" %>
      <% end %>
    <% end %>
  </div>
</div>
<div class="container">
  <div class="row justify-content-center">
    <% if @ticket %>
      <div class="col-auto">
        <%= link_to '参加をキャンセルする', event_ticket_path(@event, @ticket), method: :delete, class: 'btn btn-primary btn-lg btn-block' %>
      </div>
    <% else %>
      <% if logged_in? %>
        <div class="col-auto">
          <button class="btn btn-primary btn-lg btn-block" data-toggle="modal" data-target="#createTiket">参加する</button>
          <div class="modal dafe" id="createTiket">
            <div class="modal-dialog">
              <div class="modal-content">
                  <div class="model-header">
                    <h4 class="modal-title" id="dialogHeader">参加コメント</h4>
                    <button class="close" type="button" data-dismiss="modal">&times;</button>
                  </div>
                  <%= form_with(model: @event.tickets.build, url: event_tickets_path(@event)) do |f| %>
                    <div class="modal-body">
                      <div id="createTicketErrors">
                        <%= f.text_field :comment, class: 'form-control' %>
                      </div>
                    </div>
                    <div class="modal-footer">
                      <button class="btn btn-default" type="button" data-dismiss="modal">キャンセル</button>
                      <%= f.button '送信', class: 'btn btn-primary' %>
                    </div>
                  <% end %>
              </div>
            </div>
          </div>
        </div>
      <% else %>
        <%= link_to '参加する', new_event_ticket_path(@event), class: 'btn btn-primary btn-lg btn-block' %>
      <% end %>
    <% end %>
    <% if @event.created_by?(current_user) %>
      <div class="col-auto">
        <%= link_to 'イベント編集', edit_event_path(@event), class: 'btn btn-info btn-lg btn-block' %>
      </div>
      <div class="col-auto">
        <%= link_to 'イベント削除', event_path(@event), method: :delete, data: { confirm: '本当に削除しますか？' },  class: 'btn btn-danger btn-lg btn-block' %>
      </div>
    <% end %>
    <div class="col-auto">
      <%= link_to '戻る', 'javascript:history.back()', class: 'btn btn-secondary btn-lg btn-block' %>
    </div>
  </div>
</div>
